{
    "type": "DashboardV2SyncDefinition",
    "name": "Audit: Sumo Search Scan Optimization",
    "description": "A dashboard for viewing and optimizing high scan and poor performing searches in a Sumo Logic account using Search Audit logs.",
    "title": "Audit: Sumo Search Scan Optimization",
    "theme": "Light",
    "topologyLabelMap": {
        "data": {}
    },
    "refreshInterval": 0,
    "timeRange": {
        "type": "BeginBoundedTimeRange",
        "from": {
            "type": "RelativeTimeRangeBoundary",
            "relativeTime": "-1d"
        },
        "to": null
    },
    "layout": {
        "layoutType": "Grid",
        "layoutStructures": [
            {
                "key": "panel55606FEC9E703A4D",
                "structure": "{\"height\":12,\"width\":24,\"x\":0,\"y\":36}"
            },
            {
                "key": "panel5B92DD94845BC942",
                "structure": "{\"height\":13,\"width\":24,\"x\":0,\"y\":0}"
            },
            {
                "key": "panel19F1D9069144BB41",
                "structure": "{\"height\":9,\"width\":6,\"x\":18,\"y\":25}"
            },
            {
                "key": "panel1DFB7425A5825B4B",
                "structure": "{\"height\":2,\"width\":24,\"x\":0,\"y\":13}"
            },
            {
                "key": "panelA318AB91B1B04B4F",
                "structure": "{\"height\":16,\"width\":24,\"x\":0,\"y\":48}"
            },
            {
                "key": "panel59A9028A819B2B4A",
                "structure": "{\"height\":9,\"width\":6,\"x\":12,\"y\":25}"
            },
            {
                "key": "panelE1FFC3C0A972784D",
                "structure": "{\"height\":6,\"width\":3,\"x\":6,\"y\":15}"
            },
            {
                "key": "panel4FE25CDF9D9BCB4D",
                "structure": "{\"height\":6,\"width\":3,\"x\":9,\"y\":15}"
            },
            {
                "key": "panel8E982FE99E4A2842",
                "structure": "{\"height\":6,\"width\":6,\"x\":0,\"y\":15}"
            },
            {
                "key": "panel6A67D43DBEDDDB4F",
                "structure": "{\"height\":9,\"width\":6,\"x\":6,\"y\":25}"
            },
            {
                "key": "panelE2C7E427A931BA46",
                "structure": "{\"height\":9,\"width\":6,\"x\":0,\"y\":25}"
            },
            {
                "key": "panel2FA162F4B4B37B49",
                "structure": "{\"height\":10,\"width\":6,\"x\":0,\"y\":73}"
            },
            {
                "key": "panel821D9B8A813A0A45",
                "structure": "{\"height\":4,\"width\":3,\"x\":0,\"y\":21}"
            },
            {
                "key": "panelABC1D8C284387A49",
                "structure": "{\"height\":4,\"width\":3,\"x\":3,\"y\":21}"
            },
            {
                "key": "panelCFE24E03B2923A48",
                "structure": "{\"height\":4,\"width\":3,\"x\":6,\"y\":21}"
            },
            {
                "key": "panelE4C3E379A1FEBB45",
                "structure": "{\"height\":4,\"width\":3,\"x\":9,\"y\":21}"
            },
            {
                "key": "panel7DC65937B107EA42",
                "structure": "{\"height\":4,\"width\":3,\"x\":12,\"y\":21}"
            },
            {
                "key": "panel8E9C63B8AC58C94A",
                "structure": "{\"height\":4,\"width\":3,\"x\":15,\"y\":21}"
            },
            {
                "key": "panel9C348F21BCFA1A4C",
                "structure": "{\"height\":4,\"width\":6,\"x\":18,\"y\":21}"
            },
            {
                "key": "panel141CB72EB5D51A4F",
                "structure": "{\"height\":9,\"width\":24,\"x\":0,\"y\":64}"
            },
            {
                "key": "panel917FE145BAB7A94A",
                "structure": "{\"height\":10,\"width\":6,\"x\":6,\"y\":73}"
            },
            {
                "key": "panel87D86E3CBA458947",
                "structure": "{\"height\":10,\"width\":12,\"x\":12,\"y\":73}"
            },
            {
                "key": "panelD3C86792AA057A4C",
                "structure": "{\"height\":6,\"width\":24,\"x\":0,\"y\":83}"
            },
            {
                "key": "panel5D025AC8A6370A41",
                "structure": "{\"height\":14,\"width\":24,\"x\":0,\"y\":89}"
            },
            {
                "key": "panel108B24BBA17F994E",
                "structure": "{\"height\":6,\"width\":3,\"x\":15,\"y\":15}"
            },
            {
                "key": "panel13D8CCD58A69FB43",
                "structure": "{\"height\":6,\"width\":3,\"x\":21,\"y\":15}"
            },
            {
                "key": "panelEFBC6803AF4F3949",
                "structure": "{\"height\":2,\"width\":24,\"x\":0,\"y\":34}"
            },
            {
                "key": "panel547D06BDB3971842",
                "structure": "{\"height\":6,\"width\":3,\"x\":18,\"y\":15}"
            },
            {
                "key": "panel36EF58978C9C3A44",
                "structure": "{\"height\":6,\"width\":3,\"x\":12,\"y\":15}"
            },
            {
                "key": "panel1114182587E9194B",
                "structure": "{\"height\":14,\"width\":24,\"x\":0,\"y\":89,\"minHeight\":3,\"minWidth\":3}"
            }
        ]
    },
    "panels": [
        {
            "id": null,
            "key": "panel55606FEC9E703A4D",
            "title": "Top Scanners: User and Query Type. Use this panel to locate the user / workload combinations that drive high scans.",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":0}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query \n{{{filter}}}\n\n| where data_scanned_bytes > ({{min_scan_gb_per_search}} * 1G)\n| (query_end_time - query_start_time)/1000 as range_s\n| execution_duration_ms /1000 as duration_s\n| if(execution_duration_ms > 1000 * {{slow_seconds}},1,0) as slow\n| if(status_message = \"Finished successfully\",0,1) as fail\n// AGGREGATE TO GET STATS\n| count_distinct(query) as unique_queries,max(scanned_partition_count) as max_partitions,avg(scanned_partition_count) as avg_partitions,count_distinct(user_name) as users,sum(duration_s) as total_sec,count as searches, sum(data_scanned_bytes) as bytes_scanned,   sum(slow) as %\"slow > 30s\", sum(fail) as %\"fail/cancelled\" by user_name,query_type\n//| replace (partitions,\"\\n\",\", \") as partitions\n| sort bytes_scanned\n| bytes_scanned / 1024/1024/1024 as scan_gb \n| total_sec / (60 * 60) as total_hours | fields -bytes_scanned,total_sec\n\n| limit 200",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel5B92DD94845BC942",
            "title": "About",
            "visualSettings": "{\"general\":{\"mode\":\"TextPanel\",\"type\":\"text\",\"displayType\":\"default\"},\"title\":{\"fontSize\":14},\"text\":{\"format\":\"markdownV2\",\"fontSize\":14},\"series\":{},\"legend\":{\"enabled\":false}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "TextPanel",
            "text": "This dashboard uses the [search audit index](https://help.sumologic.com/Manage/Security/Search_Audit_Index) to help you identify high search scan users who have inefficient searches that over scan your account - for example a monitor or schedule that scans all partitions will have poor performance and can degrade search performance for all users.\n\nFilters:\n- **filter**: any search term appended to line 1 of the query such as: ```query_type=interactive*``` or ```user_name=jane.doe*```. Search audit is a view not raw data so you must filter on view columns not keywords. Columns include: ```analytics_tier, data_retrieved_bytes, data_scanned_bytes, execution_duration_ms, is_aggregate, query, query_type, retrieved_message_count, scanned_bytes_breakdown, scanned_message_count, scanned_partition_count, session_id, status_message, user_name```\n- **timeslice**: enter a timeslice value for the time series panels\n- **slow_seconds**: a number of seconds to measure a query as slow vs fast.\n- **search_max_chrs**: reduces length of search displayed in detailed tables\n- **min_scan_gb_per_search**: many panels are filtered to exclude any low scanning searches below this number. Increasing the number allows you to locate higher scanners in the UI more easily. Bear in mind this is applied per search. Sometimes a user might have many searches running (such as a monitor running every minute) that might in aggregate incur a very high scan cost.\n\nWhen troubleshooting high scan searches the following techniques are useful:\n1. look for searches that scan **many or all partitions** by checking for high partition counts. Sumo's backend tries to optmize a search to a single partition by source category but this does not always work. For best performance train users to include an index e.g : ```_index=foo``` or ```_index=foo*``` or ``` * _index=foo or _index=bar```\n\n2. If **searching data tiers use an specific index** rather than ```_datatier=all``` or ```_datatier=infrequent```\n\n3. **Scan only the required time range**. For  example scheduled searches are most optimized if the range matches the schedule interval say -15m every 15m, vs -7d every 15m which will have a high overlapped scan.\n\n4. For large searches that are repeated, **implement [scheduled views](https://help.sumologic.com/docs/manage/scheduled-views/) and query the view instead**. A pre-aggregated view will massively speed up query execution as well as reducing scan, and open up many new larger scale use cases.\n\n5. Follow other search optimizaiton best practices being:\n- include a **sourcecategory or another metadata field** like collector in every search \n- include 1 or a few **keyword expressions** to reduce the data required to be retrieved for processing. This is much faster than using parse ... where to filter later on.\n- admins should implement **[Field extraction rules](https://help.sumologic.com/docs/manage/field-extractions/)** and train users to use indexed fields in search scope to speed up searches by reducing retrieved data. Search time parsing such as ```parse .... where``` is very flexible but indexed fields are much faster."
        },
        {
            "id": null,
            "key": "panel19F1D9069144BB41",
            "title": "Gb Scan Top Users Over Time",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"title\":\"\",\"titleFontSize\":9,\"labelFontSize\":9},\"axisY\":{\"title\":\"\",\"titleFontSize\":9,\"titleFontFamily\":\"Lab Grotesque Medium, \\\"Arial Bold\\\", sans-serif\",\"titleFontColor\":\"#6D8DA6\",\"titleFontWeight\":\"normal\",\"labelFontColor\":\"#6D8DA6\",\"lineColor\":\"#DDE4E9\",\"stripLines\":null,\"gridThickness\":1,\"lineThickness\":0,\"labelFontSize\":9,\"tickColor\":\"#E6EAED\",\"logarithmic\":false,\"linear\":false,\"unit\":{\"value\":\"GB\",\"isCustom\":false},\"gridColor\":\"#E6EAED\",\"labelFontFamily\":\"Lab Grotesque Regular, \\\"Arial\\\", sans-serif\",\"labelFontWeight\":\"normal\"},\"axisY2\":{\"title\":\"\",\"titleFontSize\":9,\"titleFontFamily\":\"Lab Grotesque Medium, \\\"Arial Bold\\\", sans-serif\",\"titleFontColor\":\"#6D8DA6\",\"titleFontWeight\":\"normal\",\"labelFontColor\":\"#6D8DA6\",\"lineColor\":\"#DDE4E9\",\"stripLines\":null,\"lineThickness\":0,\"labelFontSize\":9,\"tickColor\":\"#E6EAED\",\"logarithmic\":false,\"linear\":false,\"unit\":{\"value\":\"\",\"isCustom\":false},\"gridThickness\":0,\"valueFormatString\":\"\",\"gridColor\":\"#E6EAED\",\"labelFontFamily\":\"Lab Grotesque Regular, \\\"Arial\\\", sans-serif\",\"labelFontWeight\":\"normal\"}},\"legend\":{\"enabled\":true,\"verticalAlign\":\"bottom\",\"fontSize\":9,\"maxHeight\":35,\"showAsTable\":false,\"wrap\":true},\"series\":{},\"color\":{\"family\":\"Categorical Default\"},\"overrides\":[],\"general\":{\"type\":\"column\",\"displayType\":\"stacked\",\"roundDataPoints\":true,\"fillOpacity\":1,\"mode\":\"timeSeries\"}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n| timeslice by {{timeslice}}\n|sum(data_scanned_bytes) as bytes   by _timeslice,user_name\n| total bytes as tb by _timeslice\n | bytes / tb as f | if (f <.03,\"other\",user_name) as user_name\n| bytes / 1G as gb\n| sum(gb) as gb_scan by _timeslice,user_name | replace (user_name,/@.+/,\"\") as user_name  \n| fillmissing timeslice(15m) with 0 for\tgb_scan | transpose row _timeslice column user_name",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel1DFB7425A5825B4B",
            "title": "Search Scan Overview and KPIs",
            "visualSettings": "{\"general\":{\"mode\":\"TextPanel\",\"type\":\"text\",\"displayType\":\"default\"},\"title\":{\"fontSize\":14},\"text\":{\"format\":\"markdownV2\",\"fontSize\":14},\"series\":{},\"legend\":{\"enabled\":false}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "TextPanel",
            "text": "These panels **ARE NOT**  filtered by min_scan_gb_per_search"
        },
        {
            "id": null,
            "key": "panelA318AB91B1B04B4F",
            "title": "Highest Scan Searches by total Scan GB. Use this panel to drill down to specific high scan searches.",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":0}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query \n{{{filter}}}\n| where data_scanned_bytes > ({{min_scan_gb_per_search}} * 1G)\n//| where execution_duration_ms > 15000\n| (query_end_time - query_start_time)/1000 as range_s\n| round(range_s/60/60/24) as range_day\n| range_s/60 as range_min\n| execution_duration_ms /1000 as duration_s\n// AGGREGATE TO GET STATS\n\n| values(scanned_partition_count) as partitions,values(user_name) as user_names,values(range_day) as range_days,avg(range_min) as range_minutes, sum(duration_s) as total_s,count as searches, sum(data_scanned_bytes) as bytes_scanned, sum(retrieved_message_count) as retrieved_events, avg(duration_s) as avg_duration_s by query_type,query\n| parse regex field=query \"(?i)(?<has_subquery>compare with timeshift|\\[ *subquery:)\" nodrop\n| substring(query,0,{{search_max_chrs}}) as query\n| bytes_scanned / 1G as gb_scan\n| fields -bytes_scanned\n| total_s / (60 * 60 ) as run_hours\n| sort gb_scan | limit 100 | fields -total_s,_some_matched\n| replace (partitions,\"\\n\",\", \") as partitions\n",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel59A9028A819B2B4A",
            "title": "Gb Scan Top Users",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"pie\",\"displayType\":\"default\",\"roundDataPoints\":true,\"fillOpacity\":1,\"startAngle\":270,\"innerRadius\":\"30%\",\"maxNumOfSlices\":20,\"mode\":\"distribution\",\"indexLabelFontSize\":12},\"legend\":{\"enabled\":false,\"verticalAlign\":\"bottom\",\"fontSize\":12,\"maxHeight\":50,\"showAsTable\":false,\"wrap\":true},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n| timeslice by {{timeslice}}\n|sum(data_scanned_bytes) as bytes   by user_name | replace (user_name,/@.+/,\"\") as user_name  \n| bytes / 1G as gb\n| sum(gb) as gb by user_name | sort gb ",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelE1FFC3C0A972784D",
            "title": "TB Scan By Search",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel4FE25CDF9D9BCB4D",
            "title": "Account Daily Ingest",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":3,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_index=sumologic_volume _sourceCategory=\"view_and_tier_volume\"\n  | parse regex \"(?<data>\\{[^\\{]+\\})\" multi \n  | json field=data \"field\",\"dataTier\",\"sizeInBytes\",\"count\" as index, dataTier, bytes, count   \n  | sum(bytes) as bytes | bytes/1024/1024/1024 /1024 as tb\n| avg(tb) as ingest",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel8E982FE99E4A2842",
            "title": "Scan Ratio",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"x Daily Ingest\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":7000,\"to\":1000000,\"color\":\"#bf2121\"},{\"from\":2500,\"to\":7000,\"color\":\"#DFBE2E\"},{\"from\":0,\"to\":2500,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":true,\"min\":0,\"max\":20000}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 ) as GB_Scan \n// make a lookup reference object of the last 24 hour scan total\n| \"YES\" as dummy\n| where [subquery from=(-24h): \n  _index=sumologic_volume _sourceCategory=\"view_and_tier_volume\"\n  | parse regex \"(?<data>\\{[^\\{]+\\})\" multi \n  | json field=data \"field\",\"dataTier\",\"sizeInBytes\",\"count\" as index, dataTier, bytes, count   \n  | sum(bytes) as bytes | bytes/1024/1024/1024 as gb\n  | 1 as key\n  | save /temp/ingest\n  | \"YES\" as dummy | compose dummy\n]\n| 1 as key\n| lookup gb from /temp/ingest on key=key\n| gb_scan / gb as scan_ratio | fields scan_ratio",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": {
                "type": "BeginBoundedTimeRange",
                "from": {
                    "type": "RelativeTimeRangeBoundary",
                    "relativeTime": "-1d"
                },
                "to": null
            },
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel6A67D43DBEDDDB4F",
            "title": "TB Scan By Query Type",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"pie\",\"displayType\":\"default\",\"roundDataPoints\":true,\"fillOpacity\":1,\"startAngle\":270,\"innerRadius\":\"30%\",\"maxNumOfSlices\":15,\"mode\":\"distribution\",\"indexLabelFontSize\":12},\"legend\":{\"enabled\":true,\"verticalAlign\":\"bottom\",\"fontSize\":12,\"maxHeight\":50,\"showAsTable\":false,\"wrap\":true},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n\n| sum(data_scanned_bytes) as bytes by query_type | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | sum(TB_Scan) as TB_Scan by query_type | sort tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelE2C7E427A931BA46",
            "title": "Scan Vs Last Week",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"title\":\"\",\"titleFontSize\":9,\"labelFontSize\":9},\"axisY\":{\"title\":\"\",\"titleFontSize\":9,\"titleFontFamily\":\"Lab Grotesque Medium, \\\"Arial Bold\\\", sans-serif\",\"titleFontColor\":\"#6D8DA6\",\"titleFontWeight\":\"normal\",\"labelFontColor\":\"#6D8DA6\",\"lineColor\":\"#DDE4E9\",\"stripLines\":null,\"gridThickness\":1,\"lineThickness\":0,\"labelFontSize\":9,\"tickColor\":\"#E6EAED\",\"logarithmic\":false,\"linear\":false,\"unit\":{\"value\":\"GB\",\"isCustom\":false},\"gridColor\":\"#E6EAED\",\"labelFontFamily\":\"Lab Grotesque Regular, \\\"Arial\\\", sans-serif\",\"labelFontWeight\":\"normal\"},\"axisY2\":{\"title\":\"\",\"titleFontSize\":9,\"titleFontFamily\":\"Lab Grotesque Medium, \\\"Arial Bold\\\", sans-serif\",\"titleFontColor\":\"#6D8DA6\",\"titleFontWeight\":\"normal\",\"labelFontColor\":\"#6D8DA6\",\"lineColor\":\"#DDE4E9\",\"stripLines\":null,\"lineThickness\":0,\"labelFontSize\":9,\"tickColor\":\"#E6EAED\",\"logarithmic\":false,\"linear\":false,\"unit\":{\"value\":\"\",\"isCustom\":false},\"gridThickness\":0,\"valueFormatString\":\"\",\"gridColor\":\"#E6EAED\",\"labelFontFamily\":\"Lab Grotesque Regular, \\\"Arial\\\", sans-serif\",\"labelFontWeight\":\"normal\"}},\"legend\":{\"enabled\":true,\"verticalAlign\":\"bottom\",\"fontSize\":9,\"maxHeight\":35,\"showAsTable\":false,\"wrap\":true},\"series\":{},\"color\":{\"family\":\"Categorical Default\"},\"general\":{\"type\":\"line\",\"displayType\":\"default\",\"roundDataPoints\":true,\"markerSize\":5,\"lineDashType\":\"solid\",\"markerType\":\"none\",\"lineThickness\":1,\"mode\":\"timeSeries\"},\"overrides\":[{\"series\":[\"gb_scan_7d\"],\"queries\":[],\"properties\":{\"lineDashType\":\"dot\",\"lineThickness\":2,\"color\":\"#ff5d5d\",\"name\":\"Last Week\"}}]}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n| timeslice by {{timeslice}}\n| data_scanned_bytes / 1G as gb\n| sum(gb) as gb_scan by _timeslice | compare with timeshift 7d",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel2FA162F4B4B37B49",
            "title": "Search Count By Band of Scanned Partitions By Query Type",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12,\"title\":\"query_type\"},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12,\"title\":\"count of searches executed\"}},\"series\":{},\"general\":{\"type\":\"bar\",\"displayType\":\"stacked\",\"roundDataPoints\":true,\"fillOpacity\":1,\"mode\":\"distribution\"},\"overrides\":[]}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//| where execution_duration_ms > 30000\n//not query_type = view*\nnot query_type = sumo*\n| where data_scanned_bytes > ({{min_scan_gb_per_search}} * 1G)\n\n//| where scanned_partition_count >5\n| count as searches by query_type,scanned_partition_count\n\n| toint(ceil(scanned_partition_count/5) * 5) as part_range\n| sum(searches) as searches by part_range,query_type\n| toint(part_range) as part_range | sort query_type asc,part_range asc\n| transpose row query_type column part_range",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel821D9B8A813A0A45",
            "title": "Scan UI Search",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=\"Interactive Search\")\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelABC1D8C284387A49",
            "title": "Scan Dashboards",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=*Dashboard*)\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelCFE24E03B2923A48",
            "title": "Scan Sched Search",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=\"Scheduled Search\")\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelE4C3E379A1FEBB45",
            "title": "Scan Monitors",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=\"Monitors\")\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel7DC65937B107EA42",
            "title": "Scan API",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=*api*)\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel8E9C63B8AC58C94A",
            "title": "Scan View Maintenance",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"TB\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":2,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":null,\"to\":null,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n( query_type=view*)\n\n| sum(data_scanned_bytes) as bytes | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | fields tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel9C348F21BCFA1A4C",
            "title": "Scan Other",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"legend\":{\"enabled\":true,\"verticalAlign\":\"bottom\",\"fontSize\":12,\"maxHeight\":50,\"showAsTable\":false,\"wrap\":true},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"roundDataPoints\":true,\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":2}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\nnot query_type=view* not query_type=monitors not query_type=sched* not query_type=Int* not query_type=*api* not query_type=*dash*\n\n| sum(data_scanned_bytes) as bytes by query_type | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan  | sum(tb_scan) as tb_scan by query_type | sort tb_scan",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel141CB72EB5D51A4F",
            "title": "Partition Effectiveness Profile",
            "visualSettings": "{\"general\":{\"mode\":\"TextPanel\",\"type\":\"text\",\"displayType\":\"default\"},\"title\":{\"fontSize\":14},\"text\":{\"format\":\"markdownV2\",\"fontSize\":14},\"series\":{},\"legend\":{\"enabled\":false}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "TextPanel",
            "text": "Effective partitioning by admins groups logs into [partitions](https://help.sumologic.com/docs/manage/partitions-data-tiers/) based on their categorization or query use cases. These panels help to determine how effective your partitions are scoped by users.\n\nBy default data is ingested into a single 'default' partition.\n\nSumo Admins should create discrete partitions for commonly accessed or larger log sources and give them easy to understand names, then train users to scope queries by partitions. \n\nMetered scan in sumologic is granular only to partition level - so a best practice is to move very large log sources that are less often queried to their own partitions. For example\n- if you have five large log sources: waf, cdn, web server logs, application logs and cloudtrail, a good starting partition design would be one for each major log type.\n- if you have a large log cusotm applicaiton log source that is 10% errors/warn, 20% info and 70% trace/debug but most users rarely use trace/debug logs, best practice would be to implement separate partitions for the trace/debug and info/warn/error logs to reduce scans. Keeping the trace/debug in the own partition reduces scan (improving performance) for most common queries vs error/warn/info level events.\n\nIf partitions are defined using sourcecategory the query engine will where possible restrict a query with a sourcecategory to a single partition but explicitly defining this in the search ensures best possible scope. You can determine the partitions scanned number in any query audit by checking the scanned_partition_count column.\n\nTo analyze the panels below look for:\n- high search counts or high byte scans targeting larger numbers of partitions - especially your maximum possible (all data)\n- Use the user breakdown panel to identify users that could benefit from training to add _index to their searches to avoid over scanning data."
        },
        {
            "id": null,
            "key": "panel917FE145BAB7A94A",
            "title": "Scan Bytes by Scanned Partition Band By Query Type",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12,\"title\":\"query_type\"},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12,\"unit\":{\"value\":\"B\",\"isCustom\":false},\"title\":\"total bytes scanned\"}},\"series\":{},\"general\":{\"type\":\"bar\",\"displayType\":\"stacked\",\"roundDataPoints\":true,\"fillOpacity\":1,\"mode\":\"distribution\"},\"overrides\":[]}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//| where execution_duration_ms > 30000\n//not query_type = view*\nnot query_type = sumo*\n| where data_scanned_bytes > ({{min_scan_gb_per_search}} * 1G)\n\n//| where scanned_partition_count >5\n| sum(data_scanned_bytes) as bytes by query_type,scanned_partition_count\n\n| toint(ceil(scanned_partition_count/5) * 5) as part_range\n| sum(bytes) as bytes by part_range,query_type\n| transpose row query_type column part_range",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel87D86E3CBA458947",
            "title": "Users Scanning > 3 Partitions and > 10GB. Could benefit from training to add index",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"roundDataPoints\":true,\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":null}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//| where execution_duration_ms > 30000\n//not query_type = view*\nnot query_type = sumo*\n| where scanned_partition_count >3 \n| where data_scanned_bytes > ({{min_scan_gb_per_search}} * 1G)\n\n| sum(data_scanned_bytes) as bytes,count as searches by user_name,scanned_partition_count //,query_type\n| where bytes > 10000000000\n| bytes /1024/1024/1024 as scan_gb | fields -bytes\n| ceil(scanned_partition_count/5) * 5 as part_range\n| total searches as total_searches by user_name,part_range\n| concat(toint(part_range),\": \",toint(total_searches)) as range_searches\n| sort user_name,part_range\n| values(range_searches) as %\"range: num_searches\",sum(scan_gb) as total_scan_gb,sum(searches) as total_searches by user_name\n| replace(%\"range: num_searches\",\"\\n\",\"  \") as %\"range: num_searches\"\n| sort total_scan_gb\n| round(total_scan_gb / 1024,2) as total_scan_tb\n| round(total_scan_gb) as total_scan_gb\n| round(total_scan_gb / total_searches,1) as gb_per_search\n\n",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelD3C86792AA057A4C",
            "title": "Infrequent Tier Scanners",
            "visualSettings": "{\"general\":{\"mode\":\"TextPanel\",\"type\":\"text\",\"displayType\":\"default\"},\"title\":{\"fontSize\":14},\"text\":{\"format\":\"markdownV2\",\"fontSize\":14},\"series\":{},\"legend\":{\"enabled\":false}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "TextPanel",
            "text": "Infrequent tier is a Enterprise Suite pricing plan where data can be ingested at a very low rate but each search incurs a scan charge.\n\nBest practices for infrequent scan reduction are:\n- users should scope searches by ```_index``` rather than using ```_datatier```\n- admins should partition infrequent data into discrete logical sets based on query use cases. Infrequent scans are charged at partition level so grouping smaller logs in the same partition as very large ones will increase scan charges.\n- use the [pin](https://help.sumologic.com/docs/search/get-started-with-search/build-search/best-practices-search/#pin-searches-with-long-time-ranges) feature to cache results for infrequent searches to avoid losing results on session timeout\n- when building a query fine tune the scope, parsing and formatting on a small time range. Run final version on a long time range.\n- Scan smaller time ranges to reduce scan charges where possible.\n"
        },
        {
            "id": null,
            "key": "panel5D025AC8A6370A41",
            "title": "Infrequent Users Sorted By Scan Credits Estimate (@.016/scan GB)",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"roundDataPoints\":true,\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":2}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query \n{{filter}}\n\nanalytics_tier=*infrequent*\n\n//| parse field=\"scanned_bytes_breakdown -> *)\" as scanned_bytes_breakdown \n| json field =scanned_bytes_breakdown \"Continuous\" as  scan_c nodrop\n| json field =scanned_bytes_breakdown \"Frequent\" as  scan_f nodrop\n| json field =scanned_bytes_breakdown \"Infrequent\" as  scan_inf nodrop\n\n// AGGREGATE TO GET STATS\n///| parse \" query -> *, scanned_partition_count -> \" as the_real_query\n//| sort execution_duration_ms\n| ((query_end_time - query_start_time ) /1000 / 60 /60/24) as range_days\n| parse regex field=query \"(?i)(?<scope>(?:_datatier|_index|_view) *= *[a-zA-Z]+)\" nodrop\n//| if (isempty(datatier),\"index\",datatier) as datatier\n\n| count as queries,count as searches, sum(data_scanned_bytes) as total_bytes,pct(range_days,50,95),avg(scanned_partition_count) as partitions, sum(scan_c) as cont_scan,sum(scan_f) as freq_scan,sum(scan_inf) as infreq_scan, values(status_message) as statuses,values(query_type) as types by user_name,scope | limit 100 //,session_id\n\n| round(cont_scan/1G,2) as cont_scan_gb\n| round(freq_scan/1G,2) as freq_scan_gb\n| round(infreq_scan/1G,2) as inf_scan_gb\n| total_bytes / 1G as total_scan_gb\n| round(inf_scan_gb * 0.016,2) as scan_credits //| fields -bytes\n\n| fields -cont_scan,freq_scan,infreq_scan,total_bytes\n| sort scan_credits\n\n| scan_credits/queries as cr_per_query\n\n\n\n",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel108B24BBA17F994E",
            "title": "> 10 TB Total Scan",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"Searches\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":1,\"to\":10000,\"color\":\"#DFBE2E\"},{\"from\":0,\"to\":0,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n| where data_scanned_bytes > 1000000000\n| sum(data_scanned_bytes) as bytes by query | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | sum(tb_scan) as scan_tb by query | where scan_tb > 10 | count",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel13D8CCD58A69FB43",
            "title": "> 1 PB Total Scan",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\",\"noDataMessage\":\"0\"},\"svp\":{\"option\":\"Average\",\"label\":\"Searches\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":1,\"to\":10000,\"color\":\"#bf2121\"},{\"from\":null,\"to\":null,\"color\":\"#DFBE2E\"},{\"from\":0,\"to\":0,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n| where data_scanned_bytes > 1000000000\n| sum(data_scanned_bytes) as bytes by query | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | sum(tb_scan) as scan_tb by query | where scan_tb > 1000 | count",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panelEFBC6803AF4F3949",
            "title": "High Scanners Detailed View",
            "visualSettings": "{\"general\":{\"mode\":\"TextPanel\",\"type\":\"text\",\"displayType\":\"default\"},\"title\":{\"fontSize\":14},\"text\":{\"format\":\"markdownV2\",\"fontSize\":14},\"series\":{},\"legend\":{\"enabled\":false}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "TextPanel",
            "text": "These panels **ARE filtered** by min_scan_gb_per_search"
        },
        {
            "id": null,
            "key": "panel547D06BDB3971842",
            "title": "> 100 TB Total Scan",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\",\"noDataMessage\":\"0\"},\"svp\":{\"option\":\"Average\",\"label\":\"Searches\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":1,\"to\":10000,\"color\":\"#DFBE2E\"},{\"from\":0,\"to\":0,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n| where data_scanned_bytes > 1000000000\n| sum(data_scanned_bytes) as bytes by query | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | sum(tb_scan) as scan_tb by query | where scan_tb > 100 | count",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel36EF58978C9C3A44",
            "title": "> 1 TB Total Scan",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"general\":{\"type\":\"svp\",\"displayType\":\"default\",\"mode\":\"singleValueMetrics\"},\"svp\":{\"option\":\"Average\",\"label\":\"Searches\",\"useBackgroundColor\":false,\"useNoData\":false,\"noDataString\":\"No data\",\"hideData\":false,\"hideLabel\":false,\"rounding\":0,\"valueFontSize\":24,\"labelFontSize\":14,\"thresholds\":[{\"from\":null,\"to\":null,\"color\":\"#bf2121\"},{\"from\":1,\"to\":10000,\"color\":\"#DFBE2E\"},{\"from\":0,\"to\":0,\"color\":\"#16943e\"}],\"sparkline\":{\"show\":false},\"gauge\":{\"show\":false,\"min\":0,\"max\":100}},\"series\":{}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query {{{filter}}}\n//( query_type=*view*)\n| where data_scanned_bytes > (1 * 1G)\n| sum(data_scanned_bytes) as bytes by query | bytes / (1024 * 1024 * 1024 * 1024) as TB_Scan | sum(tb_scan) as scan_tb by query | where scan_tb > 1 | count",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Auto",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        },
        {
            "id": null,
            "key": "panel1114182587E9194B",
            "title": "Infrequent Queries Sorted By Scan Credits Estimate (@.016/scan GB)",
            "visualSettings": "{\"title\":{\"fontSize\":14},\"axes\":{\"axisX\":{\"titleFontSize\":12,\"labelFontSize\":12},\"axisY\":{\"titleFontSize\":12,\"labelFontSize\":12}},\"series\":{},\"general\":{\"type\":\"table\",\"displayType\":\"default\",\"roundDataPoints\":true,\"paginationPageSize\":100,\"fontSize\":12,\"mode\":\"distribution\",\"decimals\":2}}",
            "keepVisualSettingsConsistentWithParent": true,
            "panelType": "SumoSearchPanel",
            "queries": [
                {
                    "transient": false,
                    "queryString": "_view=sumologic_search_usage_per_query \n{{filter}}\n\nanalytics_tier=*infrequent*\n\n//| parse field=\"scanned_bytes_breakdown -> *)\" as scanned_bytes_breakdown \n| json field =scanned_bytes_breakdown \"Continuous\" as  scan_c nodrop\n| json field =scanned_bytes_breakdown \"Frequent\" as  scan_f nodrop\n| json field =scanned_bytes_breakdown \"Infrequent\" as  scan_inf nodrop\n\n// AGGREGATE TO GET STATS\n///| parse \" query -> *, scanned_partition_count -> \" as the_real_query\n//| sort execution_duration_ms\n| ((query_end_time - query_start_time ) /1000 / 60 /60/24) as range_days\n| parse regex field=query \"(?i)(?<scope>(?:_datatier|_index|_view) *= *[a-zA-Z_]+)\" nodrop\n//| if (isempty(datatier),\"index\",datatier) as datatier\n\n| count as queries,count as searches, sum(data_scanned_bytes) as total_bytes,avg(range_days) as range_days,avg(scanned_partition_count) as partitions, sum(scan_c) as cont_scan,sum(scan_f) as freq_scan,sum(scan_inf) as infreq_scan, values(status_message) as statuses,values(query_type) as types by user_name,scope,query | limit 100 //,session_id\n\n| round(cont_scan/1G,2) as cont_scan_gb\n| round(freq_scan/1G,2) as freq_scan_gb\n| round(infreq_scan/1G,2) as inf_scan_gb\n| total_bytes / 1G as total_scan_gb\n| round(inf_scan_gb * 0.016,2) as scan_credits //| fields -bytes\n\n| fields -cont_scan,freq_scan,infreq_scan,total_bytes\n| sort scan_credits\n\n| scan_credits/queries as cr_per_query\n\n\n\n",
                    "queryType": "Logs",
                    "queryKey": "A",
                    "metricsQueryMode": null,
                    "metricsQueryData": null,
                    "tracesQueryData": null,
                    "spansQueryData": null,
                    "parseMode": "Manual",
                    "timeSource": "Message",
                    "outputCardinalityLimit": 1000
                }
            ],
            "description": "",
            "timeRange": null,
            "coloringRules": null,
            "linkedDashboards": []
        }
    ],
    "variables": [
        {
            "id": null,
            "name": "filter",
            "displayName": "filter",
            "defaultValue": "// any search term",
            "sourceDefinition": {
                "variableSourceType": "CsvVariableSourceDefinition",
                "values": "// anything,user_name=abc,query_type=*dashboard*"
            },
            "allowMultiSelect": false,
            "includeAllOption": false,
            "hideFromUI": false,
            "valueType": "Any"
        },
        {
            "id": null,
            "name": "timeslice",
            "displayName": "timeslice",
            "defaultValue": "15m",
            "sourceDefinition": {
                "variableSourceType": "CsvVariableSourceDefinition",
                "values": "1h,15m,1d,10m,5m"
            },
            "allowMultiSelect": false,
            "includeAllOption": false,
            "hideFromUI": false,
            "valueType": "Any"
        },
        {
            "id": null,
            "name": "slow_seconds",
            "displayName": "slow_seconds",
            "defaultValue": "30",
            "sourceDefinition": {
                "variableSourceType": "CsvVariableSourceDefinition",
                "values": "30,60,90,300"
            },
            "allowMultiSelect": false,
            "includeAllOption": false,
            "hideFromUI": false,
            "valueType": "Any"
        },
        {
            "id": null,
            "name": "search_max_chrs",
            "displayName": "search_max_chrs",
            "defaultValue": "500",
            "sourceDefinition": {
                "variableSourceType": "CsvVariableSourceDefinition",
                "values": "100,200,300,400,500,1000,10000"
            },
            "allowMultiSelect": false,
            "includeAllOption": true,
            "hideFromUI": false,
            "valueType": "Any"
        },
        {
            "id": null,
            "name": "min_scan_gb_per_search",
            "displayName": "min_scan_gb_per_search",
            "defaultValue": "1",
            "sourceDefinition": {
                "variableSourceType": "CsvVariableSourceDefinition",
                "values": "1,10,50,100,1000"
            },
            "allowMultiSelect": false,
            "includeAllOption": true,
            "hideFromUI": false,
            "valueType": "Any"
        }
    ],
    "coloringRules": []
}